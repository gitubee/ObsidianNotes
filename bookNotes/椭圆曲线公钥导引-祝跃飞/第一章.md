# 椭圆曲线
## 概述
有理多项式是否有有理解的问题，分解为两种形式：
1. **仿射**（affine）：$f(x,y)\in \mathbb{Q}[x,y]$有无有理数解，可以转化为$f(x,y)\in \mathbb{Z}[x,y]$有无有理数解
2. **投射**（projective）：问齐次方程$f(x,y,z)\in \mathbb{Q}[x,y,z]$有无有理数解
	即是否存在$(0,0,0)\neq(x,y,z)$满足$f(x,y,z)=0$；若$(x,y,z)$为解，则$t(x,y,z)$也为解，因此组成一个$\mathbb{Z}^{3}$上的等价类，即只需要考虑**整系数齐次多项式**有无整数解

进一步，考虑解有无参数化表示，上述问题统称为丢番图问题，方程称为丢番图方程。
投射可以转化为仿射，部分仿射也可以转化为投射
比如$x^{n}+y^{n}=1$的有理解，等价于$a^n+b^n=c^n$的整数解，即费马大定理
从一些简单的投射问题入手，考虑如下问题：
1. **一次投射方程**：$ax+by+cz=0$，可以参数化其解
2. **二次投射丢番图方程**：通过线性变换，不妨设为$ax^2+by^2+cz^2=0$
	(a) $x^2+y^2+z^2=0$，显然无非平凡解；
	(b) $x^2+y^2-3z^2=0$，无解：
	证明，取最小的互素解，证它们存在公因子3
	二次丢番图方程有整数解，显然实数域上有解，且在任意p-adic整环上有解，反之呢？
	Hasse给出了正式的归纳（Hasse-Minkowski原理）：若一个二次齐次方程在$\mathbb{Q}$上有解，当且仅当它在$\mathbb{R}$和任意$\mathbb{Q}_{p}$上有解。
3. **三次投射丢番图方程**
	(a) 三次Fermat方程：$x^3+y^3=z^3$;
	(b) 同余数(congruent)问题：$r\in\mathbb{Q}$称为同余数，若r是一个有理数边组成的直角三角形的面积，即：$r=\frac{1}{2}xy$, 其中$x,y,z\in\mathbb{Q}$ 且 $x^2+y^2=z^2$；
	(c) 对于给定的数，比如6，能否将其分为两部分有理数，使其乘积为一个数的立方与此数的差，即：
	$y(6-y)=x^3-x$是否有有理数解？
	(d) Bacht问题：考虑一个有理数如何写成一个平方数和一个立方数的差，即：$y^2-x^3=c$ 是否有有理数解？
	1621年，bacht证明了若$(x,y)$是一个解，则：
	$$
	\bigg(\frac{x^4-8cx}{4y^2},\frac{-x^6-20cx^3+8c^2}{8y^3}\bigg)
	$$
	也是一个解。

上述四个例子均可以归结为一类三次方程：即Weierstrass方程，
	$$y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6\qquad a_i\in Q$$
光滑的W方程的曲线，加上一个特定点O（无穷远点）称为$\mathbb{Q}$上的椭圆曲线，如：
$$E(\mathbb{R})=\{(x,y)\in\mathbb{R}^2:y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6\}\cup\{O\}$$
从几何角度，使用弦切法可以在$E(\mathbb{R})$上定义“+”运算，对于椭圆曲线上的点P,Q，过PQ的直线必和椭圆曲线有第三个交点，过该点和O的直线与椭圆曲线的另一个交点即定义为$P+Q$，如图。
则$(E(\mathbb{R},+))$构成群（Poincare定理），$(E(\mathbb{Q},+))$是其子群。
本文主要讨论$K$为有限域$\mathbb{F}_q$的情况。
## 仿射曲线平面
K表示代数闭域。
##### 定义1.2.1：仿射平面（affine plane）
集合$K\times K$称为K上的仿射平面，记作$A^{2}(K)$

##### 定义1.2.2：仿射曲线
K上的一个仿射曲线是指$K[X,Y]$中一个不可约多项式C的零点集，即$C(K)=\{(a,b)\in A^{2}(K):C(a,b)=0\}$。

若给定K上的不可约多项式C也可看做K的某个子集K上的多项式，即$C\in k[X,Y]$，则以后常称仿射曲线$C(K)$的子集$C(K)=\{(a,b)\in k^2:C(a,b)=0\}$为C在k上的有理点集。
###### 例1.1： 
令$K=\mathbb{R},k=\mathbb{C}$，曲线D，E，F，G在$\mathbb{R}$上的有理点集的构成如图1.2所示。
* $D:Y^2-(x^3+X^2)$
* $E:Y^2-(x^3-X)$
* $F:Y^2-X^3$

因为K是代数闭域，因此任意曲线都有无穷多个点。
#question <span style="font-style:oblique;color:red">为什么？</span>

##### 定义1.2.3：奇异点/非奇异点，奇异曲线/非奇异曲线
设C是一条曲线，$P=(a,b)$是C上一个点，若$\frac{\partial C}{\partial X}|_{(a,b)}=\frac{\partial C}{\partial Y}|_{(a,b)}=0$，则称P是C上的奇异点，否则称P为C上的非奇异点或光滑点，且称$\frac{\partial C}{\partial X}|_{P}(X-a)+\frac{\partial C}{\partial Y}|_{P}(Y-b)=0$为C在P点的切线，一条含有奇异点的曲线称为奇异曲线，否则称为非奇异曲线或光滑曲线。
###### 例1.2
对于仿射曲线同例1.1：则有$(0,0)$是D和F上的奇异点，不是E上的奇异点。

将C在$P=(a,b)$上展开，则：
$C(X,Y)=\frac{\partial C}{\partial X}|_{P}(X-a)+\frac{\partial C}{\partial Y}|_{P}(Y-b)+$高次项
易得，P为C奇异点当且仅当上述展开式没有一次项。

观察奇异点展开式的二次项，在代数闭域上，二次项一定是能写成两个一次项的乘积，即：
$$
\begin{align*}
&\alpha(X-a)^2+\beta(X-a)(Y-b)+\gamma(Y-b)^2\\
=&(\alpha_1(X-a)+\beta_1(Y-a))(\alpha_2(X-a)+\beta_2(Y-a))
\end{align*}
$$
对于一个奇异点P，如果$\alpha_1(X-a)+\beta_1(Y-a)=\alpha_2(X-a)+\beta_2(Y-a)$，则称P为一个 #尖点 （cusp），否则称为 #叉点 （node）。
例如，曲线D在$(0,0)$处存在两条切线：$Y=\pm X$，故是叉点；而E在$(0,0)$处有一条二重切线$X=0$，故是尖点。

对于$g(X,Y)\in K[X,Y]$，可如下定义$C\rightarrow K$的映射，即：
$$
g(X,Y):(a,b)\mapsto g(a,b)
$$
该映射通常称为多项式映射，显然对于任意多项式$f,g\in K[X,Y]$，其作为多项式映射相等，当且仅当$C|f-g$。
##### 定义1.2.4：曲线上的多项式环
曲线C上的多项式环为$K[C]=K[X,Y]/(C)$，即是全体多项式映射组成的集合，是曲线C的 #坐标环 。

为描述方便，将X，Y在$K[C]$中的剩余类仍然记作X，Y。
因为C不可约，所以$K[C]$是 #整环 。
> 交换且没有零因子的称为整环

##### 定义1.2.5
$K[C]$的分布域称为C上的有理函数域，记作K(C).
##### 定义1.2.6
设有理函数$r\in K(C)$，$P\in C$，若存在$f,g\in K[C]$，使得$r=\frac{f}{g}$，且$g(P)\neq 0$，则称$r$**在P点正则**（regular），记$r(P)=\frac{f(P)}{g(P)}$；在P点正则的有理函数的全体构成环，称为**C在P点的局部环**，记作$O_{P}(C)$，若$r$在P点不正则，常记作$r(P)=\infty$。

需要注意，该定义是良定义的，即对不同的$f_1,g_1,f_2,g_2$使:
$$r=\frac{f_1}{g_1}=\frac{f_2}{g_2},f_1,g_1,f_2,g_2\in K[C], g_1(P)\neq 0,g_2(P)\neq 0$$
其诱导出的$r(P)$是相同的。

验证$O_{P}(C)$的确是一个环，且为 #局部环 。其单位全体为：
$$O_{P}(C)^{\times}=\{\frac{f}{g}:f(P),g(P)\neq 0\}$$
其唯一的最大理想为：
$$m_{P}(C)=\{\frac{f}{g}:f(P)=0,g(P)\neq 0\}$$

###### 例1.3
设$E:Y^2=X^3-X$，其图像如图2.1右侧所示，考虑有理函数$r=\frac{X}{Y}$，当$P=(0,0)$时，$X(P)=Y(P)=0$，此时分子分母全为0，但是可以使用另外一种形式：
$$
r=\frac{X}{Y}=\frac{XY}{Y^2}=\frac{XY}{X^3-X}=\frac{Y}{X^2-1}
$$
此时$Y(P)=0,(X^2-1)(P)=-1\neq 0$，可以得到$r(P)=0$。
设$s=\frac{1}{r}=\frac{Y}{X}$，则$s$在$P$点处就不是正则的，否则$s(P)\in K$从而得出矛盾：
$$
1=1(P)=(rs)(P)=r(P)s(P)=0s(P)=0
$$

##### 定理1.2.7
设C是一条曲线，$P=(a,b)\in C$，则：
1. $K[C]$是一维诺特整环；
2. 其极大理想均为$\wp=(X-a,Y-b)$；
3. $O_{P}(C)=K[C]_{\wp}$，$K[C]_{\wp}$是$K[C]$对于$\wp$的局部化；
4. $O_{P}(C)$是离散赋值环 当且仅当 $P$是$C$的非奇异点；

证明：
$K[X,Y]$的极大理想均为$(X-s,Y-t),(s,t)\in K$，
所以$K[C]$的极大理想为：$\frac{(X-a,Y-b)}{(C)}$，其中$C(a,b)=0$;
故C上的点与$K[C]$的极大理想一一对应，证明如下：
$$
\begin{align*}
K[C]_{\wp}&=\{\frac{g}{h}:g,h\in K[C],h\notin\wp\}\\
&=\{\frac{g}{h}:g,h\in K[C],h(a,b)\neq 0\}=O_{P}(C)
\end{align*}
$$
因为$O_{P}(C)=K[C]_{\wp}$是一维诺特整环，则$O_{P}(C)$是离散赋值环 当且仅当 $O_{P}(C)$是整闭的，当且仅当$O_{P}(C)$是主理想整环
设$P=(a,b)$是C的非奇异点，要证明$O_{P}(C)$是主理想整环，由习题1.5以及$O_{P}(C)$是一维诺特整环，只需证明所有极大理想都是主理想即可。
###### 推论 1.2.8
设C是一条曲线，则$K[C]$是戴德金整环当且仅当C是光滑曲线。
## 仿射椭圆曲线
##### 定义2.7：仿射Weierstrass方程
称形如：
$$
E:Y^2=a_{1}XY+a_{3}Y=x^3+a_{2}X^2+a_{4}X+a_{6},
\qquad a_{1},a_{3},a_{2},a_{4},a_{5}\in K
$$
的方程为K上的仿射Weierstrass方程，记：
$$
\begin{align*}
b_{2}&=a^2_{1}+4a_{2},\\
b_{4}&=2a_{4}+a_{1}a_{3},\\
b_{4}&=2a_{4}+a_{1}a_{3},
\end{align*}
$$
##### 定理 1.3.2
E在$K[X,Y]$中是不可约的。

证明：易证，E在$K[X,Y]$中不可约，当且仅当E在$K(X)[Y]$中不可约
假设E在在$K[X,Y]$中可约，则$E=(Y+s)(Y+r),r,s\in K(X)$，则有：
$$
\begin{align*}
r+s&=a_1X+a_3\\
rs&=-(X^3+a_2X^2+a_4+a_6)
\end{align*}
$$
对于$f,g\in K[X,Y]$，我们有：
$$
\begin{align*}
\deg\frac{f}{g}&=\deg f-\deg g\\
\deg fg&=\deg f+\deg g\\
\deg(f+g)&\leq \max\{\deg f,\deg g\}
\end{align*}
$$
且当$\deg f\neq \deg g$时，第三式等号成立。则有：
$$
1=\deg(r+s)=\max\{\deg r,\deg s\}\geq \frac{3}{2}
$$
矛盾。

下面考虑不改变Weierstrass方程形式的可逆仿射变换，设对Weierstrass方程E，通过可逆线性变换$\psi$进行作用：
即，要保持Weierstrass方程形式不变，要求仿射变换$\psi$可逆，且形式为：
$$
\bigg\{
\begin{array}{rl}
X & \leftarrow u^2 X'+r\\
Y & \leftarrow u^2 s X'+u^3 Y'+t
\end{array}
$$
其中$u\in K^{\times},r,s,t\in K$，将这种仿射称为允许变换（admissable change）。
##### 定义 1.3.3：Weierstrass方程的同构
称Weierstrass方程决定的曲线：
$$
\begin{align*}
E:Y^2=a_{1}XY+a_{3}Y=x^3+a_{2}X^2+a_{4}X+a_{6}\\
E':Y^2=a_{1}'XY+a_{3}'Y=x^3+a_{2}'X^2+a_{4}'X+a_{6}'
\end{align*}
$$
是 #同构 的，如果$E'$可由$E$通过允许变换得到。

以允许变换对W方程进行变换，得到的不同的曲线之间，构成同构关系，且该同构具有反身性，对称性和传递性，因此构成W方程上的 #等价关系 。

证明：
1. 反身性：易得；
2. 对称性，对一个同构，可以得到其对称同构：
$$
\bigg\{
\begin{align*}
X'&\leftarrow\frac{1}{u^2}(X-r)\\
Y'&\leftarrow\frac{1}{u^3}(-sX+Y+sr-t)
\end{align*}
$$
3. 传递性，对两个同构，

在代数闭域上，两条W曲线同构，则这条曲线具有相同的$j$不变量；且如果两条W曲线非奇异且$j$不变量相同，则这两个曲线同构。
若Weierstrass方程非奇异，则j不变量有意义

每个允许变换$\psi$，本质上给出了同构曲线之间的一个双射：

进一步，W方程上的从$E$到$E'$的允许变换，可以自然的扩展到$K[E]$到$K[E']$，则易知$\psi$也诱导了$O_{P}(E)$到$O_{\phi(P)}(E')$的同构。

$\psi$也是$K(X)$的自同构。
对于$K(E)$的共轭映射$\sigma$，则令$\sigma'=\psi\circ\sigma\circ\psi'$，$\sigma'$是$K(E')$共轭映射。

因此，对于$E$的性质研究，仅需对$E$所在的同构类进行研究即可。以下对W方程进行化简，以便获得形式较为简单的同构类的代表元。
> Char(K)：域的特征，域中单位元相加得到零元的最小次数。

根据域特征$Char(K)$的取值，对W方程进行不同的化简，得到的结果如下：







